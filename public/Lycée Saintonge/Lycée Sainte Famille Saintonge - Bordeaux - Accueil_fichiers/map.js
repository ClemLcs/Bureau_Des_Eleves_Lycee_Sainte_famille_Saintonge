(function($){var defaults={'buildings':[],'lat':false,'lng':false,'zoom':14,'scrollwheel':false,'draggable':true,'mapTypeControl':{'display':false,'position':'RIGHT_BOTTOM'},'panControl':{'display':false,'position':'RIGHT_CENTER'},'zoomControl':{'display':true,'style':'LARGE','position':'LEFT_CENTER'},'scaleControl':{'display':true,'position':'RIGHT_BOTTOM'},'streetViewControl':{'display':false,'position':'RIGHT_CENTER'},'mapStyle':[{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]}],'infobox_content':'','infobox_display':false,'infobox_options':{'pixelOffsetX':-150.5,'pixelOffsetY':0,'boxStyle':{'background':"transparent url(css/map_info.png) no-repeat left top",'opacity':1,'width':"280px",'height':"130px",'padding':"20px 10px 10px 10px",'color':"#000",'fontSize':"12px"},'closeBoxMargin':"0 0 0 0",'closeBoxURL':"css/map_close.png",'disableAutoPan':false,'maxWidth':0},'itineraryForm':'#itineraryForm','itineraryInput':'#itineraryFrom','itinerarySubmit':'#itinerarySubmit','itineraryPanel':'#itineraryPanel','itineraryPanelContent':'.itinerary_directions','itineraryTo':'.labelto','monuments':'#monuments','selectors':'input[type="radio"]','active':'checked','places':'#places_list','streetview':'#streetview','satellite':'#satellite','map':'#map','view3d':'#view3d','itinerary':'#print_itinerary','print':'.print_it','close':'.close_it','reverse':'.reverse_it','travelmode':'#traveling_mode','driving':'.driving','bicycling':'.bicycling','transit':'.transit','walking':'.walking','marker':'css/marker.png','train_station':'css/marker_train_station.png','airport':'css/marker_airport.png','subway_station':'css/marker_subway_station.png','taxi_stand':'css/marker_taxi_stand.png','cafe':'css/marker_cafe.png','restaurant':'css/marker_restaurant.png','museum':'css/marker_museum.png','art_gallery':'css/marker_art_gallery.png','print_path':'print_itinerary.php','minRadius':1000,'maxRadius':10000,'link_text':'directions to the building','error':'ERROR','noplaces_text':'No places were found!','onLoad':function(){},'visualRefresh':false,'directionsDisplay':false,'directionsService':false,'is_checked':false,'panorama':false,'streetview_options':{'heading':0,'pitch':0},'panBy':{'x':null,'y':null},'group':false,'group_fit_bounds':true,'pois':null,'poiCategories':new Array(),'display_pois':false,'blank':'css/blank.gif','travel':'DRIVING','markercluster':false,'hostname':'','display':false,'delta':3}
var methods={init:function(options){if($(this).length==0){return;}
if(window[plugin]===undefined){window[plugin]=new Array();}
pi=window[plugin].length;window[plugin].push(pi);window[plugin][pi]=$.extend({},defaults,options);window[plugin][pi].element=$(this);window[plugin][pi].element.addClass('loading');var jsscript=document.getElementsByTagName("script");for(var i=0;i<jsscript.length;i++){var pattern=new RegExp('/'+plugin+'/i');if(pattern.test(jsscript[i].getAttribute("src"))){window[plugin][pi].hostname=jsscript[i].getAttribute("src").split("/");window[plugin][pi].hostname.pop();window[plugin][pi].hostname=window[plugin][pi].hostname.join('/')+'/';}}
var pattern=new RegExp('/https:\/\//i');if(!pattern.test(window[plugin][pi].marker)){window[plugin][pi].marker=window[plugin][pi].hostname+window[plugin][pi].marker;}
if(!pattern.test(window[plugin][pi].train_station)){window[plugin][pi].train_station=window[plugin][pi].hostname+window[plugin][pi].train_station;}
if(!pattern.test(window[plugin][pi].airport)){window[plugin][pi].airport=window[plugin][pi].hostname+window[plugin][pi].airport;}
if(!pattern.test(window[plugin][pi].subway_station)){window[plugin][pi].subway_station=window[plugin][pi].hostname+window[plugin][pi].subway_station;}
if(!pattern.test(window[plugin][pi].taxi_stand)){window[plugin][pi].taxi_stand=window[plugin][pi].hostname+window[plugin][pi].taxi_stand;}
if(!pattern.test(window[plugin][pi].cafe)){window[plugin][pi].cafe=window[plugin][pi].hostname+window[plugin][pi].cafe;}
if(!pattern.test(window[plugin][pi].restaurant)){window[plugin][pi].restaurant=window[plugin][pi].hostname+window[plugin][pi].restaurant;}
if(!pattern.test(window[plugin][pi].museum)){window[plugin][pi].museum=window[plugin][pi].hostname+window[plugin][pi].museum;}
if(!pattern.test(window[plugin][pi].art_gallery)){window[plugin][pi].art_gallery=window[plugin][pi].hostname+window[plugin][pi].art_gallery;}
if(window[plugin][pi].buildings.length>0){window[plugin][pi].group=true;$(window[plugin][pi].monuments).hide();$(window[plugin][pi].itineraryForm).hide();}
if($(window[plugin][pi].element).offset().top<=$(window).innerHeight()&&window[plugin][pi].display===false){methods.loadGoogleMap(pi);}else{$(window).on('load',function(){methods.loadGoogleMap(pi);}).on('scroll',function(){methods.loadGoogleMap(pi);});}},loadGoogleMap:function(pi){if(($(document).scrollTop()+window[plugin][pi].delta*$(window[plugin][pi].element).innerHeight())>=$(window[plugin][pi].element).offset().top&&window[plugin][pi].display===false){if(typeof(google)==='undefined'){window[plugin][pi].display=true;var script=document.createElement("script");script.type="text/javascript";script.onload=function(){methods.loadInfobox(pi);if(window[plugin][pi].markercluster!==false){methods.loadMarkerCluster(pi);}};document.getElementsByTagName("head")[0].appendChild(script);script.src='https://maps.google.com/maps/api/js?key=AIzaSyA5ekcjg54P-lnmhebpPqiN6xonK4FiNa4&v=3.exp&libraries=places';}else{if(window[plugin][pi].markercluster!==false && typeof(MarkerClusterer)==='undefined'){methods.loadMarkerCluster(pi);};window[plugin][pi].display=true;methods.construct(pi);}}},loadInfobox:function(pi){var script=document.createElement("script");script.type="text/javascript";script.onload=function(){methods.construct(pi);};document.getElementsByTagName("head")[0].appendChild(script);script.src='https://onpc.tech/wp-content/themes/onpc-websites/js/Infobox.js';},loadMarkerCluster:function(pi){var script=document.createElement("script");script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);script.src='https://onpc.tech/wp-content/themes/onpc-websites/js/markerclusterer.js';},construct:function(pi){if(window[plugin][pi].lat!==false&&window[plugin][pi].lng!==false||window[plugin][pi].group==true){window[plugin][pi].directionsService=new google.maps.DirectionsService();google.maps.visualRefresh=window[plugin][pi].visualRefresh;if(window[plugin][pi].group==true){for(var h in window[plugin][pi].buildings){window[plugin][pi].buildings[h].building=new google.maps.LatLng(window[plugin][pi].buildings[h].lat,window[plugin][pi].buildings[h].lng);}}else{window[plugin][pi].building=new google.maps.LatLng(window[plugin][pi].lat,window[plugin][pi].lng);}
window[plugin][pi].directionsDisplay=new google.maps.DirectionsRenderer();window[plugin][pi].mapOptions={zoom:window[plugin][pi].zoom,center:((window[plugin][pi].group==true)?window[plugin][pi].buildings[0].building:window[plugin][pi].building),mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:window[plugin][pi].scrollwheel,mapTypeControl:window[plugin][pi].mapTypeControl.display,mapTypeControlOptions:{position:eval('google.maps.ControlPosition.'+window[plugin][pi].mapTypeControl.position)},panControl:window[plugin][pi].panControl.display,panControlOptions:{position:eval('google.maps.ControlPosition.'+window[plugin][pi].panControl.position)},zoomControl:window[plugin][pi].zoomControl.display,zoomControlOptions:{style:eval('google.maps.ZoomControlStyle.'+window[plugin][pi].zoomControl.style),position:eval('google.maps.ControlPosition.'+window[plugin][pi].zoomControl.position)},scaleControl:window[plugin][pi].scaleControl.display,scaleControlOptions:{position:eval('google.maps.ControlPosition.'+window[plugin][pi].scaleControl.position)},streetViewControl:window[plugin][pi].streetViewControl.display,streetViewControlOptions:{position:eval('google.maps.ControlPosition.'+window[plugin][pi].streetViewControl.position)}};window[plugin][pi].mapCanvas=new google.maps.Map(window[plugin][pi].element.get(0),window[plugin][pi].mapOptions);if(window[plugin][pi].mapStyle.length>0){window[plugin][pi].mapCanvas.setOptions({styles:window[plugin][pi].mapStyle});}else{window[plugin][pi].mapCanvas.setOptions({styles:[{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]}]});}
window[plugin][pi].mapCanvas.setOptions({'draggable':window[plugin][pi].draggable});window[plugin][pi].bounds=new google.maps.LatLngBounds();if(window[plugin][pi].group==true){window[plugin][pi].markers=new Array(window[plugin][pi].buildings.length);for(var h in window[plugin][pi].buildings){window[plugin][pi].markers[h]=new google.maps.Marker({position:window[plugin][pi].buildings[h].building,map:window[plugin][pi].mapCanvas,icon:window[plugin][pi].buildings[h].marker});window[plugin][pi].bounds.extend(window[plugin][pi].markers[h].position);window[plugin][pi].buildings[h].infobox={content:window[plugin][pi].buildings[h].infobox_content,disableAutoPan:window[plugin][pi].infobox_options.disableAutoPan,maxWidth:window[plugin][pi].infobox_options.maxWidth,pixelOffset:new google.maps.Size(window[plugin][pi].infobox_options.pixelOffsetX,window[plugin][pi].infobox_options.pixelOffsetY),zIndex:null,boxStyle:window[plugin][pi].infobox_options.boxStyle,closeBoxMargin:window[plugin][pi].infobox_options.closeBoxMargin,closeBoxURL:window[plugin][pi].infobox_options.closeBoxURL,infoBoxClearance:new google.maps.Size(1,1),isHidden:false,pane:"floatPane",enableEventPropagation:false};window[plugin][pi].buildings[h].infowindow=new InfoBox(window[plugin][pi].buildings[h].infobox);google.maps.event.addListener(window[plugin][pi].buildings[h].infowindow,'closeclick',function(){$(window[plugin][pi].itineraryForm).hide();$(window[plugin][pi].monuments).hide();$(window[plugin][pi].places).hide();if(window[plugin][pi].markerPlace!==undefined){for(var n in window[plugin][pi].markerPlace){for(var i=0,_lpn=window[plugin][pi].markerPlace[n].length;i<_lpn;i++){window[plugin][pi].markerPlace[n][i].setMap(null);}}}
window[plugin][pi].mapCanvas.fitBounds(window[plugin][pi].bounds);});}}else{window[plugin][pi].marker=new google.maps.Marker({position:window[plugin][pi].building,map:window[plugin][pi].mapCanvas,icon:window[plugin][pi].marker});window[plugin][pi].bounds.extend(window[plugin][pi].marker.position);window[plugin][pi].infobox={content:window[plugin][pi].infobox_content,disableAutoPan:window[plugin][pi].infobox_options.disableAutoPan,maxWidth:window[plugin][pi].infobox_options.maxWidth,pixelOffset:new google.maps.Size(window[plugin][pi].infobox_options.pixelOffsetX,window[plugin][pi].infobox_options.pixelOffsetY),zIndex:null,boxStyle:window[plugin][pi].infobox_options.boxStyle,closeBoxMargin:window[plugin][pi].infobox_options.closeBoxMargin,closeBoxURL:window[plugin][pi].infobox_options.closeBoxURL,infoBoxClearance:new google.maps.Size(1,1),isHidden:false,pane:"floatPane",enableEventPropagation:false};window[plugin][pi].infowindow=new InfoBox(window[plugin][pi].infobox);if(window[plugin][pi].infobox_display==true){window[plugin][pi].infowindow.open(window[plugin][pi].mapCanvas,window[plugin][pi].marker);}
if(window[plugin][pi].pois!=null){var _elem=$(window[plugin][pi].monuments).children().first().clone();$(window[plugin][pi].monuments).children().remove();var _categories=new Array();window[plugin][pi].poiInfowindow=new google.maps.InfoWindow();if(window[plugin][pi].display_pois==true){window[plugin][pi].markerPOI=new Array();}
$.map($.makeArray(window[plugin][pi].pois),function(value,n){if(window.console&&console.log&&value.category===undefined){console.log('G_Map : The place '+value.name+' has no specified category');return false;}
var _slug=methods.slugify(value.category);var _poi=$('<'+_elem.get(0).tagName+' class="'+_slug+'"><input type="radio" name="place_poi_'+pi+'" id="place_poi_'+pi+'_'+n+'"><label for="place_poi_'+pi+'_'+n+'">'+value.name+'</label></'+_elem.get(0).tagName+'>');if(value.category!==undefined){if($.inArray(_slug,window[plugin][pi].poiCategories)==-1){window[plugin][pi].poiCategories[_slug]=value.category;}
if($.inArray(_slug,_categories)==-1){_categories.push(_slug);_categories[_slug]=new Array();window[plugin][pi].markerPOI[_slug]=new Array();}
_categories[_slug].push(_poi);}else{_poi.appendTo($(window[plugin][pi].monuments));}
if(window[plugin][pi].display_pois==false){$('input',_poi).on('change',function(){if(window[plugin][pi].markerPOI!==undefined){window[plugin][pi].markerPOI.setMap(null);}
window[plugin][pi].markerPOI=new google.maps.Marker({map:window[plugin][pi].mapCanvas,position:new google.maps.LatLng(value.lat,value.lng),icon:window[plugin][pi].blank});google.maps.event.addListener(window[plugin][pi].markerPOI,'click',(function(plugin,value){return function(){plugin.poiInfowindow.setContent('<div class="map_infobox">'+value.content+'<a href="javascript:;" onclick="jQuery.fn.G_Map(\'poi\',\''+pi+'\',\''+value.lat+','+value.lng+'\')" class="place_itinerary">'+plugin.link_text+'</a></div>');plugin.poiInfowindow.open(plugin.mapCanvas,this);}})(window[plugin][pi],value));google.maps.event.trigger(window[plugin][pi].markerPOI,'click');});}else{window[plugin][pi].markerPOI[_slug][n]=new google.maps.Marker({map:window[plugin][pi].mapCanvas,position:new google.maps.LatLng(value.lat,value.lng),icon:window[plugin][pi].blank});window[plugin][pi].markerPOI[_slug][n].setVisible(false);google.maps.event.addListener(window[plugin][pi].markerPOI[_slug][n],'click',(function(plugin,value){return function(){plugin.poiInfowindow.setContent('<div class="map_infobox">'+value.content+'<a href="javascript:;" onclick="jQuery.fn.G_Map(\'poi\',\''+pi+'\',\''+value.lat+','+value.lng+'\')" class="place_itinerary">'+plugin.link_text+'</a></div>');plugin.poiInfowindow.open(plugin.mapCanvas,this);}})(window[plugin][pi],value));$('input',_poi).on('change',function(){google.maps.event.trigger(window[plugin][pi].markerPOI[_slug][n],'click');});}});if(_categories.length>0){_categories.map(function(val,cat){var _slug=methods.slugify(val);var _category=$('<'+_elem.get(0).tagName+'><strong data-item="'+_slug+'">'+window[plugin][pi].poiCategories[_slug]+'</strong><'+$(window[plugin][pi].monuments).get(0).tagName+'></'+$(window[plugin][pi].monuments).get(0).tagName+'></'+_elem.get(0).tagName+'>');_category.appendTo($(window[plugin][pi].monuments));_categories[_slug].map(function(value,item){$(value).appendTo($(''+$(window[plugin][pi].monuments).get(0).tagName+'',_category));});$('strong',_category).on('click',function(){if(window[plugin][pi].poiInfowindow){window[plugin][pi].poiInfowindow.close();}
for(var p in window[plugin][pi].markerPOI){if(p!==$(this).attr('data-item')){$.map(window[plugin][pi].markerPOI[p],function(el){if(el!==undefined){el.setVisible(false);el.setMap(null);}});}}
$.map(window[plugin][pi].markerPOI[$(this).attr('data-item')],function(el){if(el!==undefined){el.setVisible(true);el.setMap(window[plugin][pi].mapCanvas);window[plugin][pi].bounds.extend(el.position);}});window[plugin][pi].mapCanvas.fitBounds(window[plugin][pi].bounds);});});}}}
if($(window[plugin][pi].itineraryInput).length>0){window[plugin][pi].input=$(window[plugin][pi].itineraryInput).get(0);window[plugin][pi].autocomplete=new google.maps.places.Autocomplete(window[plugin][pi].input);window[plugin][pi].autocomplete.bindTo('bounds',window[plugin][pi].mapCanvas);}
if(window[plugin][pi].markercluster!==false){methods.cluster(pi);}
google.maps.event.addListenerOnce(window[plugin][pi].mapCanvas,'idle',function(){google.maps.event.trigger(window[plugin][pi].mapCanvas,'resize');if(typeof(window[plugin][pi].panBy)=='object'&&$.isNumeric(window[plugin][pi].panBy.x)==true&&$.isNumeric(window[plugin][pi].panBy.y)==true){window[plugin][pi].mapCanvas.panBy(window[plugin][pi].panBy.x,window[plugin][pi].panBy.y);}else{if(window[plugin][pi].group==true&&window[plugin][pi].group_fit_bounds==true){window[plugin][pi].mapCanvas.fitBounds(window[plugin][pi].bounds);}else{window[plugin][pi].mapCanvas.panTo(window[plugin][pi].marker.getPosition());}}
if(window[plugin][pi].pois==null){$(window[plugin][pi].monuments).find(window[plugin][pi].selectors).on('click',function(){var _item=$(this).attr('data-item');if(window[plugin][pi].is_checked==_item){$(this).prop('checked',false);window[plugin][pi].is_checked=false;}else{window[plugin][pi].is_checked=_item;}
methods.places(pi);});}
if(window[plugin][pi].display_pois==true&&window[plugin][pi].group_fit_bounds==true){window[plugin][pi].mapCanvas.fitBounds(window[plugin][pi].bounds);}
window[plugin][pi].element.removeClass('loading');window[plugin][pi].onLoad();});if(window[plugin][pi].group==true){for(var h in window[plugin][pi].buildings){google.maps.event.addListener(window[plugin][pi].markers[h],'click',(function(marker,map,plugin,infowindow,buildings,name){return function(){plugin.current_infowindow=infowindow;plugin.current_marker=marker;plugin.building=marker.getPosition();plugin.lat=plugin.building.lat();plugin.lng=plugin.building.lng();$(plugin.monuments).show();$(plugin.itineraryTo).text(name);$(plugin.itineraryForm).show();for(var n in buildings){if(buildings[n].infowindow){buildings[n].infowindow.close();}}
if(plugin.infobox_display==true){infowindow.open(map,marker);map.panTo(marker.getPosition());}}})(window[plugin][pi].markers[h],window[plugin][pi].mapCanvas,window[plugin][pi],window[plugin][pi].buildings[h].infowindow,window[plugin][pi].buildings,window[plugin][pi].buildings[h].name));}}else{google.maps.event.addListener(window[plugin][pi].marker,'click',function(){if(window[plugin][pi].infobox_display==true){window[plugin][pi].infowindow.open(window[plugin][pi].mapCanvas,window[plugin][pi].marker);window[plugin][pi].mapCanvas.panTo(window[plugin][pi].marker.getPosition());}});}
google.maps.event.addDomListener(window,'resize',function(){if(typeof(window[plugin][pi].panBy)!='object'||$.isNumeric(window[plugin][pi].panBy.x)==false||$.isNumeric(window[plugin][pi].panBy.y)==false){if(window[plugin][pi].group==true){window[plugin][pi].mapCanvas.fitBounds(window[plugin][pi].bounds);}else{window[plugin][pi].mapCanvas.panTo(window[plugin][pi].building);}}});window[plugin][pi].directionsDisplay.setMap(window[plugin][pi].mapCanvas);window[plugin][pi].panorama=window[plugin][pi].mapCanvas.getStreetView();if(window[plugin][pi].group==false){window[plugin][pi].panorama.setPosition(window[plugin][pi].building);window[plugin][pi].panorama.setPov(({heading:parseInt(window[plugin][pi].streetview_options.heading),pitch:parseInt(window[plugin][pi].streetview_options.pitch)}));}
window[plugin][pi].keycode=null;$(window[plugin][pi].itinerarySubmit).on('click',function(){methods.calcRoute(pi);});$(window[plugin][pi].input).on('keypress',function(e){window[plugin][pi].keycode=(e.keyCode?e.keyCode:e.which);if(window[plugin][pi].keycode==13){methods.calcRoute(pi);}});$(window[plugin][pi].streetview).on('click',function(){methods.toggleStreetView(pi);});$(window[plugin][pi].satellite).on('click',function(){window[plugin][pi].panorama.setVisible(false);window[plugin][pi].mapCanvas.setMapTypeId(google.maps.MapTypeId.SATELLITE);});$(window[plugin][pi].map).on('click',function(){window[plugin][pi].panorama.setVisible(false);window[plugin][pi].mapCanvas.setMapTypeId(google.maps.MapTypeId.ROADMAP);});$(window[plugin][pi].view3d).on('click',function(){methods.toggle3DView(pi);});$(window[plugin][pi].travelmode).find(window[plugin][pi].driving).on('click',function(){methods.travelMode(pi,'DRIVING');});$(window[plugin][pi].travelmode).find(window[plugin][pi].bicycling).on('click',function(){methods.travelMode(pi,'BICYCLING');});$(window[plugin][pi].travelmode).find(window[plugin][pi].transit).on('click',function(){methods.travelMode(pi,'TRANSIT');});$(window[plugin][pi].travelmode).find(window[plugin][pi].walking).on('click',function(){methods.travelMode(pi,'WALKING');});}},places:function(pi){if(window[plugin][pi]!==undefined){window[plugin][pi].panorama.setVisible(false);if(window[plugin][pi].infowindow){window[plugin][pi].infowindow.close();}
if(window[plugin][pi].markerPlace!==undefined){for(var n in window[plugin][pi].markerPlace){for(var i=0,_lpn=window[plugin][pi].markerPlace[n].length;i<_lpn;i++){window[plugin][pi].markerPlace[n][i].setMap(null);}}}
window[plugin][pi].placesList=$(window[plugin][pi].places).get(0);window[plugin][pi].placesList.innerHTML='';if($(window[plugin][pi].itineraryPanel).find(window[plugin][pi].itineraryPanelContent).children().length>0){$(window[plugin][pi].itineraryPanel).slideUp();$(window[plugin][pi].itineraryPanel).find(window[plugin][pi].itineraryPanelContent).html('');window[plugin][pi].directionsDisplay.setMap(null);if(window[plugin][pi].group==true){window[plugin][pi].mapCanvas.panTo(window[plugin][pi].building);}
else{window[plugin][pi].mapCanvas.panTo(window[plugin][pi].marker.getPosition());}}
window[plugin][pi].activeSelectors=$(window[plugin][pi].monuments+' '+window[plugin][pi].selectors+':'+window[plugin][pi].active);if(window[plugin][pi].activeSelectors.length>0){window[plugin][pi].markerPlace=new Array(window[plugin][pi].activeSelectors.length);window[plugin][pi].activeSelectors.each(function(){var _type=$(this).data('item');var _radius=window[plugin][pi].minRadius;if(_type=='airport'){var _radius=window[plugin][pi].maxRadius;}
var request={location:window[plugin][pi].building,radius:_radius,rankby:google.maps.places.RankBy.DISTANCE,types:[_type]};window[plugin][pi].placeInfowindow=new google.maps.InfoWindow();var service=new google.maps.places.PlacesService(window[plugin][pi].mapCanvas);service.nearbySearch(request,function(results,status){if(status===google.maps.places.PlacesServiceStatus.ZERO_RESULTS){var _itemList=$('<li class="place_item"><strong>'+window[plugin][pi].noplaces_text+'</strong></li>');$(window[plugin][pi].placesList).append(_itemList);}else if(status!=google.maps.places.PlacesServiceStatus.OK){return;}else{window[plugin][pi].markerPlace[_type]=new Array(results.length);for(var i=0,_rl=results.length;i<_rl;i++){if(window[plugin][pi].markerPlace[_type][i]){window[plugin][pi].markerPlace[_type][i].setMap(null);}
window[plugin][pi].markerPlace[_type][i]=new google.maps.Marker({map:window[plugin][pi].mapCanvas,position:results[i].geometry.location,icon:window[plugin][pi][_type]});window[plugin][pi].bounds.extend(results[i].geometry.location);results[i].image='';if(results[i].photos){results[i].image='<img style="float:left;margin:0 1em 1em 0;" src="'+results[i].photos[0].getUrl({'maxWidth':results[i].photos[0].width,'maxHeight':results[i].photos[0].height})+'" width="50">';}
var _itemList=$('<li class="place_item" data-item="[\''+_type+'\']['+i+']"><img src="'+results[i].icon+'" class="place_picto"><strong>'+results[i].name+'</strong></li>');results[i].placeItinerary=$('<a href="javascript:;" onclick="jQuery.fn.G_Map(\'poi\',\''+pi+'\',\''+results[i].geometry.location.lat()+','+results[i].geometry.location.lng()+'\',\''+_type+'\')" class="place_itinerary">'+window[plugin][pi].link_text+'</a>');results[i].placeContent='<div class="map_infobox">'+results[i].image+'<div style="float:left; width:150px;" class="infobox"><strong>'+results[i].name+'</strong><br>'+results[i].vicinity+'</div><br><br>'+results[i].placeItinerary[0].outerHTML+'</div>';$(window[plugin][pi].placesList).append(_itemList);google.maps.event.addListener(window[plugin][pi].markerPlace[_type][i],'click',(function(plugin,i){return function(){plugin.placeInfowindow.setContent(results[i].placeContent);plugin.placeInfowindow.open(plugin.mapCanvas,this);}})(window[plugin][pi],i));_itemList.on('click',function(){var _point=eval('window[plugin][pi].markerPlace'+$(this).attr('data-item'));google.maps.event.trigger(_point,'click');});}
if(_type=='airport'){window[plugin][pi].mapCanvas.fitBounds(window[plugin][pi].bounds);}
else{if(window[plugin][pi].group==true){window[plugin][pi].mapCanvas.panTo(window[plugin][pi].building);}else{window[plugin][pi].mapCanvas.panTo(window[plugin][pi].marker.getPosition());}
window[plugin][pi].mapCanvas.setZoom(window[plugin][pi].zoom);}}});});}}},toggleStreetView:function(pi){if(window[plugin][pi]!==undefined){var toggle=window[plugin][pi].panorama.getVisible();if(toggle==false){window[plugin][pi].panorama.setVisible(true);}else{window[plugin][pi].panorama.setVisible(false);}}},toggle3DView:function(pi){if(window[plugin][pi]!==undefined){var toggle=window[plugin][pi].mapCanvas.getTilt();window[plugin][pi].panorama.setVisible(false);if(toggle===0){window[plugin][pi].mapCanvas.setMapTypeId(google.maps.MapTypeId.SATELLITE);window[plugin][pi].mapCanvas.setZoom(18);window[plugin][pi].mapCanvas.setTilt(45);}else{window[plugin][pi].mapCanvas.setMapTypeId(google.maps.MapTypeId.ROADMAP);window[plugin][pi].mapCanvas.setZoom(window[plugin][pi].zoom);window[plugin][pi].mapCanvas.setTilt(0);}}},calcRoute:function(pi,start,type,poi,end){if(window[plugin][pi]!==undefined){window[plugin][pi].panorama.setVisible(false);if(start==undefined||typeof(start)=='object'){var start=$(window[plugin][pi].itineraryInput).val();}
if(start==''){start=window[plugin][pi].start;}
var travelMode=google.maps.DirectionsTravelMode[window[plugin][pi].travel];if(end===undefined){var end=window[plugin][pi].lat+','+window[plugin][pi].lng;}
var request={origin:start,destination:end,travelMode:travelMode};if(poi!==undefined&&poi==true){request={origin:end,destination:start,travelMode:travelMode};}
if($.trim(start)==''||end=='0,0'){return;}
window[plugin][pi].directions={'start':request.origin,'end':request.destination};if(poi!==undefined&&poi==true){window[plugin][pi].directions={'start':end,'end':start};}
window[plugin][pi].directionsService.route(request,function(response,status){if(status==google.maps.DirectionsStatus.OK){if(window[plugin][pi].group==true){for(var n in window[plugin][pi].buildings){if(window[plugin][pi].buildings[n].infowindow){window[plugin][pi].buildings[n].infowindow.close();}
if(window[plugin][pi].poiInfowindow){window[plugin][pi].poiInfowindow.close();}}}else{if(typeof(window[plugin][pi].infowindow)!=='undefined'){window[plugin][pi].infowindow.close();}
if(window[plugin][pi].poiInfowindow){window[plugin][pi].poiInfowindow.close();}}
if(typeof(window[plugin][pi].placeInfowindow)!=='undefined'){window[plugin][pi].placeInfowindow.close();}
window[plugin][pi].directionsDisplay.setMap(window[plugin][pi].mapCanvas);$(window[plugin][pi].itineraryPanel).find(window[plugin][pi].itineraryPanelContent).html('');window[plugin][pi].directionsDisplay.setPanel($(window[plugin][pi].itineraryPanel).find(window[plugin][pi].itineraryPanelContent).get(0));window[plugin][pi].directionsDisplay.setDirections(response);$(window[plugin][pi].itineraryPanel).slideDown();function closeDirections(){window[plugin][pi].directionsDisplay.setMap(null);window[plugin][pi].mapCanvas.setZoom(window[plugin][pi].zoom);if(window[plugin][pi].group==true){window[plugin][pi].current_infowindow.open(window[plugin][pi].mapCanvas,window[plugin][pi].current_marker);window[plugin][pi].mapCanvas.panTo(window[plugin][pi].building);}else{window[plugin][pi].infowindow.open(window[plugin][pi].mapCanvas,window[plugin][pi].marker);window[plugin][pi].mapCanvas.panTo(window[plugin][pi].marker.getPosition());}
if(window[plugin][pi].markerPOI!==undefined){$(window[plugin][pi].markerPOI).each(function(){this.setMap(null);});}
window[plugin][pi].directionsDisplay=new google.maps.DirectionsRenderer();$(window[plugin][pi].itineraryPanel).stop(true,true).slideUp(function(){$(window[plugin][pi].itineraryPanel).find(window[plugin][pi].itineraryPanelContent).html('');});return false;}
$(window[plugin][pi].close).unbind('click',closeDirections);$(window[plugin][pi].close).on('click',closeDirections);$(window[plugin][pi].print).unbind('click');$(window[plugin][pi].print).on('click',function(){methods.print_itinerary(pi);});$(window[plugin][pi].reverse).unbind('click');$(window[plugin][pi].reverse).on('click',function(){$(window[plugin][pi].itineraryPanel).slideUp(function(){if(poi==true){if(type!='airport'){type='walking';}
methods.calcRoute(pi,window[plugin][pi].directions.start,type,poi,window[plugin][pi].directions.end);}else{if(type===undefined){type='airport';}
methods.calcRoute(pi,window[plugin][pi].directions.end,type,poi,window[plugin][pi].directions.start);}});});}else{alert(window[plugin][pi].error);}});}},poi:function(pi,start,type){$(window[plugin][pi].itineraryInput).val('');window[plugin][pi].start=start;methods.calcRoute(pi,start,type,true);},travelMode:function(pi,mode){if(typeof(mode)!=='undefined'){window[plugin][pi].travel=mode;methods.calcRoute(pi);}},print_itinerary:function(pi){if(window[plugin][pi]!==undefined){var html=$(window[plugin][pi].itineraryPanel).find(window[plugin][pi].itineraryPanelContent).html(),hiddenForm=$('<form/>',{style:'display:none;',target:'printwindow',method:'post',action:window[plugin][pi].hostname+window[plugin][pi].print_path});hiddenForm.append($('<input/>',{type:'hidden',name:'html',value:html}));window.open('','printwindow','toolbar=no,width=1000,height=550,menubar=no,scrollbars=yes,resizable=yes');$('body').append(hiddenForm);hiddenForm.submit();}},cluster:function(pi){var _clusterInte=setInterval(function(){if(typeof(MarkerClusterer)==='function'){clearInterval(_clusterInte);if(typeof(window[plugin][pi].markercluster)==='string'||typeof(window[plugin][pi].markercluster)==='object'){var markerCluster=new MarkerClusterer(window[plugin][pi].mapCanvas,window[plugin][pi].markers,{imagePath:((typeof(window[plugin][pi].markercluster)==='string')?window[plugin][pi].markercluster:false),styles:((typeof(window[plugin][pi].markercluster)==='object')?window[plugin][pi].markercluster:false)});}}},100);},override:function(param){var element=this;var _inteMap=setInterval(function(){if(typeof(google)==='object'&&typeof(window[plugin])!=='undefined'){clearInterval(_inteMap);for(var l in window[plugin]){if(window[plugin][l].element.selector===element.selector){var _desMap=setInterval(function(){if($(window[plugin][l].element.selector).attr('style')!==''){clearInterval(_desMap);$(window[plugin][l].element.selector).removeAttr('style');$(window[plugin][l].element.selector).children().first().remove();$(window[plugin][l].element.selector).G_Map(param);}},100);}}}},100);},slugify:function(text){return text.toString().toLowerCase().replace(/\s+/g,'-').replace(/[^\w\-]+/g,'').replace(/\-\-+/g,'-').replace(/^-+/,'').replace(/-+$/,'');}};var plugin='G_Map';$.fn.G_Map=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments);}else{$.error('Method '+method+' does not exist on jQuery.G_Map');}};})(jQuery);